#!/bin/bash
set -e

# Always run from app directory
cd /rails

echo "Rails environment: ${RAILS_ENV}"

# Run database setup ONLY in production
if [ "$RAILS_ENV" = "production" ]; then
  echo "Preparing database (create + migrate)..."
  bundle exec rails db:prepare
fi

echo "Starting Rails server..."
exec "$@"
